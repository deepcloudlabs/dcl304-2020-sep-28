<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RxJs Exercise #4</title>
    <script type="text/javascript" src="js/lib/rx.all.js"></script>
    <script type="text/javascript" src="js/lib/rx.dom.js"></script>
    <script type="text/javascript">
        // Group movies by their directors and count movies
        window.onload = () => {
            Rx.DOM.get("resources/movies.json")
                .subscribe( data => {
                    let movies = JSON.parse(data.response);
                    let observableMovies = Rx.Observable.from(movies);
                    observableMovies.flatMap( movie => movie.directors.map( director => [director, movie]))
                                    .groupBy( pair => pair[0].name )
                        .mergeMap( list =>{
                            const list2 = list.count();
                            return list2.map( count => ({ director: list.key, count}));
                        })
                        .subscribe( console.log );
                })
        }
    </script>
</head>
<body>

</body>
</html>